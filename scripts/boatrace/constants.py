"""Shared constants for boatrace scripts."""

# Stadium name to code mapping (standard boatrace stadium codes 1-24)
STADIUM_NAME_TO_CODE = {
    'ボートレース桐生': 1,
    'ボートレース戸田': 2,
    'ボートレース江戸川': 3,
    'ボートレース平和島': 4,
    'ボートレース多摩川': 5,
    'ボートレース浜名湖': 6,
    'ボートレース蒲郡': 7,
    'ボートレース常滑': 8,
    'ボートレース津': 9,
    'ボートレース三国': 10,
    'ボートレースびわこ': 11,
    'ボートレース琵琶湖': 11,  # Alternative name for びわこ
    'ボートレース住之江': 12,
    'ボートレース尼崎': 13,
    'ボートレース鳴門': 14,
    'ボートレース丸亀': 15,
    'ボートレース児島': 16,
    'ボートレース宮島': 17,
    'ボートレース徳山': 18,
    'ボートレース下関': 19,
    'ボートレース若松': 20,
    'ボートレース芦屋': 21,
    'ボートレース福岡': 22,
    'ボートレース唐津': 23,
    'ボートレース大村': 24,
}

# Reverse mapping: code to name
STADIUM_CODE_TO_NAME = {v: k for k, v in STADIUM_NAME_TO_CODE.items()
                        if k != 'ボートレース琵琶湖'}

# Data-driven advantage maps per stadium (derived from historical 1st-place rates)
STADIUM_ADVANTAGE_MAP = {
    1:  {1: 5.0, 2: 1.0, 3: 1.0, 4: 1.0, 5: 0.4, 6: 0.0},  # 桐生
    2:  {1: 5.0, 2: 1.7, 3: 1.5, 4: 1.2, 5: 0.3, 6: 0.0},  # 戸田
    3:  {1: 5.0, 2: 1.7, 3: 1.2, 4: 1.0, 5: 0.4, 6: 0.0},  # 江戸川
    4:  {1: 5.0, 2: 1.5, 3: 1.2, 4: 0.9, 5: 0.3, 6: 0.0},  # 平和島
    5:  {1: 5.0, 2: 1.2, 3: 1.0, 4: 0.8, 5: 0.4, 6: 0.0},  # 多摩川
    6:  {1: 5.0, 2: 1.1, 3: 1.1, 4: 0.6, 5: 0.3, 6: 0.0},  # 浜名湖
    7:  {1: 5.0, 2: 0.9, 3: 0.8, 4: 0.7, 5: 0.2, 6: 0.0},  # 蒲郡
    8:  {1: 5.0, 2: 0.8, 3: 0.6, 4: 0.6, 5: 0.2, 6: 0.0},  # 常滑
    9:  {1: 5.0, 2: 1.1, 3: 0.9, 4: 0.7, 5: 0.3, 6: 0.0},  # 津
    10: {1: 5.0, 2: 1.3, 3: 1.1, 4: 0.6, 5: 0.2, 6: 0.0},  # 三国
    11: {1: 5.0, 2: 1.2, 3: 1.1, 4: 0.8, 5: 0.5, 6: 0.0},  # びわこ
    12: {1: 5.0, 2: 1.0, 3: 0.8, 4: 0.6, 5: 0.3, 6: 0.0},  # 住之江
    13: {1: 5.0, 2: 0.8, 3: 0.9, 4: 0.6, 5: 0.2, 6: 0.0},  # 尼崎
    14: {1: 5.0, 2: 1.3, 3: 1.3, 4: 0.9, 5: 0.4, 6: 0.0},  # 鳴門
    15: {1: 5.0, 2: 1.0, 3: 0.9, 4: 0.6, 5: 0.3, 6: 0.0},  # 丸亀
    16: {1: 5.0, 2: 1.0, 3: 0.8, 4: 0.5, 5: 0.2, 6: 0.0},  # 児島
    17: {1: 5.0, 2: 1.0, 3: 0.9, 4: 0.7, 5: 0.3, 6: 0.0},  # 宮島
    18: {1: 5.0, 2: 1.0, 3: 0.6, 4: 0.5, 5: 0.1, 6: 0.0},  # 徳山
    19: {1: 5.0, 2: 0.8, 3: 0.7, 4: 0.5, 5: 0.1, 6: 0.0},  # 下関
    20: {1: 5.0, 2: 0.7, 3: 0.8, 4: 0.6, 5: 0.2, 6: 0.0},  # 若松
    21: {1: 5.0, 2: 0.6, 3: 0.6, 4: 0.6, 5: 0.2, 6: 0.0},  # 芦屋
    22: {1: 5.0, 2: 1.1, 3: 1.2, 4: 0.6, 5: 0.2, 6: 0.0},  # 福岡
    23: {1: 5.0, 2: 1.3, 3: 0.9, 4: 0.7, 5: 0.3, 6: 0.0},  # 唐津
    24: {1: 5.0, 2: 0.8, 3: 0.7, 4: 0.5, 5: 0.2, 6: 0.0},  # 大村
}

DEFAULT_ADVANTAGE_MAP = {1: 5, 2: 3, 3: 2, 4: 1, 5: 0, 6: 0}

# Columns that represent placement averages (1-6 range, midpoint = 3.5)
PLACE_COLS = {'今節_平均着順', '今節_最新着順', '履歴_平均着順', '当場_平均着順'}

# Columns that represent rates/percentages (fill with median, not 0)
RATE_COLS = {
    '全国勝率', '全国2連対率', '当地勝率', '当地2連対率',
    'モーター2連対率', 'ボート2連対率', '今節_3連対率',
    '履歴_1着率', 'イン1着率', '当場_1着率',
}
